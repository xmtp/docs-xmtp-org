---
description: Learn how to use the reply content type to support quote replies in your app built with XMTP
---

# Support replies in your app built with XMTP

Use the reply content type to support quote replies in your app. A reply is a method to directly respond to a specific message in a conversation. Users can select and reply to a particular message instead of sending a new one.

## Use a local database for performance

Use a local database to store replies. This will enable your app to performantly display a reply with its [referenced message](#send-a-reply) when rendering message lists.

## Configure the content type

For Browser SDK (v6.0.0+) and Node SDK (v5.0.0+), replies are built-in and do not require codec registration. Skip this step for these SDKs.

For other SDKs, register the codec:

:::code-group

```js [React Native]
const client = await Client.create(signer, {
  env: 'production',
  codecs: [new ReplyCodec()],
});
```

```kotlin [Kotlin]
import org.xmtp.android.library.codecs.ReplyCodec

Client.register(codec = ReplyCodec())
```

```swift [Swift]
Client.register(codec: ReplyCodec())
```

:::

## Send a reply

Once you've created a reply, you can send it. Replies are represented as objects with two keys:

- `reference`: ID of the message being replied to

- `content`: String representation of the reply

:::code-group

```ts [Browser]
import { encodeText } from '@xmtp/browser-sdk';

const reply = {
  reference: someMessageID,
  referenceInboxId: senderInboxId, // Inbox ID of the original message sender
  content: await encodeText('I concur'),
};

await conversation.sendReply(reply);
```

```ts [Node]
import { encodeText } from '@xmtp/node-sdk';

const reply = {
  reference: someMessageID,
  referenceInboxId: senderInboxId, // Inbox ID of the original message sender
  content: encodeText('I concur'),
};

await conversation.sendReply(reply);
```

```js [React Native]
// Assuming you have a conversation object and the ID of the message you're replying to
const replyContent = {
  reply: {
    reference: messageId, // ID of the message you're replying to
    content: {
      text: 'This is a reply', // Content of the reply
    },
  },
};

await conversation.send(replyContent);
```

```kotlin [Kotlin]
import org.xmtp.android.library.codecs.ContentTypeReply
import org.xmtp.android.library.codecs.ContentTypeText
import org.xmtp.android.library.codecs.Reply

// Assuming aliceConversation and messageToReact are already defined
val reply = Reply(
    reference = messageToReact.id,
    content = "Hello",
    contentType = ContentTypeText
)

aliceConversation.send(
    content = reply,
    options = SendOptions(contentType = ContentTypeReply),
)
```

```swift [Swift]
let reply = Reply(
  reference: messageToReply.id,
  content: "Hello",
  contentType: ContentTypeText
)

try await conversation.send(
  content: reply,
  options: .init(contentType: ContentTypeReply)
)
```

:::

## Receive the content type

:::code-group

```ts [Browser]
import { contentTypesAreEqual } from '@xmtp/content-type-primitives';
import { contentTypeReply } from '@xmtp/browser-sdk';

if (contentTypesAreEqual(message.contentType, await contentTypeReply())) {
  const reply = message.content;

  // Access the reply text
  console.log('Reply:', reply.content);

  // Access the content type of the original message being replied to
  const originalContentType = await reply.contentType();
  console.log('Original message content type:', originalContentType);
}
```

```ts [Node]
import { contentTypesAreEqual } from '@xmtp/content-type-primitives';
import { contentTypeReply } from '@xmtp/node-sdk';

if (contentTypesAreEqual(message.contentType, contentTypeReply())) {
  const reply = message.content;

  // Access the reply text
  console.log('Reply:', reply.content);

  // Access the content type of the original message being replied to
  const originalContentType = reply.contentType;
  console.log('Original message content type:', originalContentType);
}
```

```jsx [React Native]
if (message.contentTypeId === "xmtp.org/reply:1.0") {
  const reply = message.content();
  if (reply) {
    const replyContent: ReplyContent = reply;
    const replyContentType = replyContent.contentType;
    const codec = client.codecRegistry[replyContentType];
    const actualReplyContent = codec.decode(replyContent.content);
  }
}
```

```kotlin [Kotlin]
if (encodedContent.type == ContentTypeReply) {
    // The message is a reply
    val reply: Reply? = message.content()
    println("Reply to: ${reply?.reference}")
    println("Content: ${reply?.content}")
}
```

```swift [Swift]
let content: Reply = try message.content()
```

:::

To handle unsupported content types, refer to the [fallback](/chat-apps/content-types/fallback) section.

## Enhanced reply structure

Starting with Browser SDK v6.3.0+ and Node SDK v5.3.0+, reply messages include an enhanced structure with access to the content type of the original message:

:::code-group

```ts [Browser]
interface EnrichedReply<T = unknown, U = unknown> {
  referenceId: string;
  content: T;
  contentType: () => Promise<ContentTypeId | undefined>;
  inReplyTo: DecodedMessage<U> | null;
}
```

```ts [Node]
interface EnrichedReply<T = unknown, U = unknown> {
  referenceId: string;
  content: T;
  contentType: ContentTypeId | undefined;
  inReplyTo: DecodedMessage<U> | null;
}
```

:::

This enhanced structure allows you to:
- Access the `contentType` of the original message being replied to
- Determine how to render the reply based on the original message type
- Build more sophisticated reply UI experiences

## Display the reply

How you choose to display replies in your app is up to you. It might be useful to look at the user experience for replies in popular apps such as Telegram and Discord.
For example, in Discord, users can reply to individual messages, and the reply provides a link to the original message.

Note that the user experience of replies in iMessage and Slack follows more of a threaded pattern, where messages display in logical groupings, or threads. This reply content type doesn't support the threaded pattern. If you'd like to request support for a threaded reply pattern, [post an XIP idea](https://community.xmtp.org/c/development/ideas/54).
