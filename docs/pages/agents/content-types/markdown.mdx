# Support markdown with your agent built with XMTP

Use the markdown content type to send rich text messages with formatting, links, and structured content. This content type allows you to send messages with markdown syntax that can be rendered as formatted text in compatible clients.

## Install the package

:::code-group

```bash [npm]
npm i @xmtp/content-type-markdown
```

```bash [yarn]
yarn add @xmtp/content-type-markdown
```

```bash [pnpm]
pnpm add @xmtp/content-type-markdown
```

:::

## Configure the content type

After importing the package, you can register the codec:

```js [Node]
import { MarkdownCodec } from "@xmtp/content-type-markdown";

// Create the XMTP agent
const agent = await Agent.create(signer, {
  env: "dev",
  codecs: [new MarkdownCodec()],
});
```

## Send markdown messages

You can send markdown content using the markdown content type:

```ts [Node]
import { ContentTypeMarkdown } from "@xmtp/content-type-markdown";

const markdownContent = `
# Welcome to XMTP!

This is a **markdown message** with various formatting options:

## Features
- *Italic text*
- **Bold text**
- \`Code snippets\`
- [Links](https://xmtp.org)
- Lists
- And more!

\`\`\`javascript
// Code blocks are supported too
const message = "Hello XMTP!";
console.log(message);
\`\`\`

> Blockquotes for important information
`;

await ctx.conversation.send(markdownContent, {
  contentType: ContentTypeMarkdown,
});
```

## Receive markdown messages

Listen for markdown messages using the agent-sdk:

```ts [Node]
// Listen for markdown messages
agent.on("markdown", async (ctx) => {
  const markdownContent = ctx.message.content;
  console.log("Received markdown:", markdownContent);
  
  // Process the markdown content
  await ctx.sendText("Thanks for the markdown message!");
});

// You can also check for markdown in the general message handler
agent.on("message", async (ctx) => {
  const contentType = ctx.message.contentType;
  if (contentType?.typeId === "markdown") {
    const markdownContent = ctx.message.content;
    console.log("Received markdown content:", markdownContent);
  }
});
```

## Complete Example

Here's a complete example of an agent that handles markdown messages:

```ts [Node]
import { Agent, createSigner, createUser } from "@xmtp/agent-sdk";
import { MarkdownCodec, ContentTypeMarkdown } from "@xmtp/content-type-markdown";

const agent = await Agent.create(signer, {
  env: "dev",
  codecs: [new MarkdownCodec()],
});

// Handle markdown messages
agent.on("markdown", async (ctx) => {
  const markdownContent = ctx.message.content;
  
  // Send a formatted response
  const response = `
# Message Received!

I received your markdown message:

${markdownContent}

## Response
Thanks for using **markdown**! I can process and respond with formatted content too.
  `;
  
  await ctx.conversation.send(response, {
    contentType: ContentTypeMarkdown,
  });
});

// Handle text messages with markdown formatting
agent.on("text", async (ctx) => {
  if (ctx.message.content.toLowerCase().includes("format")) {
    const markdownResponse = `
# Formatted Response

Here's some **formatted content** for you:

## Features
- Rich text formatting
- Code syntax highlighting
- Links and references
- Structured lists

\`\`\`typescript
// Example code block
const agent = await Agent.create(signer, {
  env: "dev",
  codecs: [new MarkdownCodec()],
});
\`\`\`

> This is a blockquote with important information!
    `;
    
    await ctx.conversation.send(markdownResponse, {
      contentType: ContentTypeMarkdown,
    });
  }
});

await agent.start();
```

## Markdown Features

The markdown content type supports standard markdown syntax including:

### Text Formatting
- **Bold text** using `**text**` or `__text__`
- *Italic text* using `*text*` or `_text_`
- `Inline code` using backticks
- ~~Strikethrough~~ using `~~text~~`

### Headers
```markdown
# Header 1
## Header 2
### Header 3
```

### Lists
```markdown
- Unordered list item
- Another item

1. Ordered list item
2. Another item
```

### Links and Images
```markdown
[Link text](https://example.com)
![Image alt text](https://example.com/image.png)
```

### Code Blocks
```markdown
```javascript
const code = "with syntax highlighting";
```
```

### Blockquotes
```markdown
> This is a blockquote
> It can span multiple lines
```

### Tables
```markdown
| Column 1 | Column 2 |
|----------|----------|
| Cell 1   | Cell 2   |
```

## Best Practices

1. **Use markdown for rich content**: When you need to send formatted text, links, or structured information
2. **Keep it readable**: Ensure your markdown renders well in different clients
3. **Fallback gracefully**: Some clients might not support full markdown rendering
4. **Test your formatting**: Verify that your markdown renders correctly before sending

## Client Compatibility

Not all XMTP clients may support markdown rendering. For maximum compatibility:

- Use simple formatting when possible
- Provide fallback text for complex formatting
- Test with different clients to ensure proper rendering
- Consider using plain text for critical information
