# Create an XMTP Agent

Create an XMTP agent that can use the signing capabilities provided by a signer. This signer links the agent to the appropriate EOA or SCW.


## Create an agent

### Basic creation

```tsx [Node]
import { Agent, createSigner, createUser } from "@xmtp/agent-sdk";
import { getRandomValues } from "node:crypto";

// Option 1: Create a local user + signer 
const user = createUser(privateKey);
const signer = createSigner();

// Option 2: Use your own wallet signer
// const signer: Signer = { /* ... */ };

const agent = await Agent.create(signer, {
  env: "dev", // or 'production'
  dbEncryptionKey: getRandomValues(new Uint8Array(32)), // save it for later
});
```


## Environment Variables

The XMTP Agent SDK allows you to use environment variables (`process.env`) for easier configuration without modifying code. Simply set the following variables and call `Agent.createFromEnv()`:

**Available Variables:**

| Variable                 | Purpose                                                                                                                      | Example                                 |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| `XMTP_WALLET_KEY`        | [Private key for wallet](https://docs.xmtp.org/inboxes/core-messaging/create-a-signer)                                       | `XMTP_WALLET_KEY=0x1234...abcd`         |
| `XMTP_ENV`               | [Network environment](https://docs.xmtp.org/agents/core-messaging/create-a-client#xmtp-network-environments)                 | `XMTP_ENV=dev` or `XMTP_ENV=production` |
| `XMTP_DB_ENCRYPTION_KEY` | [Database encryption key](https://docs.xmtp.org/agents/core-messaging/create-a-client#keep-the-database-encryption-key-safe) | `XMTP_DB_ENCRYPTION_KEY=0xabcd...1234`  |

Using the environment variables, you can setup your agent in just a few lines of code:


### Using environment variables

```tsx [Node]
// Load variables from .env file
process.loadEnvFile(".env");

// Create agent using environment variables
const agent = await Agent.createFromEnv();
```



### Configuration options

```tsx [Node]
import type { ContentCodec } from "@xmtp/content-type-primitives";

type AgentOptions = {
  env?: "local" | "dev" | "production"; // Default: "dev"
  appVersion?: string; // e.g., 'my-agent/1.0'
  dbPath?: string | null | ((inboxId: string) => string);
  dbEncryptionKey?: Uint8Array;
  codecs?: ContentCodec[];
};
```

**Key options:**

- `env`: Network environment (`"dev"`, `"production"`, or `"local"`)
- `dbPath`: Database file path (defaults to current directory)
- `dbEncryptionKey`: Required for secure local storage
- `codecs`: Additional content types support

## Smart Contract Wallets (SCW)

When working with Smart Contract Wallets, you can create an XMTP agent using the wallet's seed or private key:

```tsx [Node]
import { Agent, createSigner, createUser } from "@xmtp/agent-sdk";

const walletData = await initializeWallet("wallet.json");
/* Create the signer using viem and parse the encryption key for the local db */
const user = createUser(walletData.seed as `0x${string}`);
const signer = createSigner(user);

// Create agent with SCW signer
const agent = await Agent.create(signer);

agent.on("text", async (ctx) => {
  await ctx.conversation.send("Hello from SCW agent!");
});

await agent.start();
```
