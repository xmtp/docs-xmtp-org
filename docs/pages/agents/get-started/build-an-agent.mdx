# Build XMTP agents

Use the [XMTP Agent SDK](https://www.npmjs.com/package/@xmtp/agent-sdk) to build agents that interact with the XMTP network.

## Prerequisites

Install a [Node.js LTS release](https://nodejs.org/) and run the following commands to get started:

```bash
# Create a folder for your agent code
mkdir my-agent
cd my-agent

# Initialize a new project with ES module support
npm init --init-type=module -y

# Install TypeScript as development dependency (-D)
npm i -D typescript

# Install tsx to run TypeScript files directly
# without a separate build step
npm i -D tsx

# Install Node.js type definitions
# to enable TypeScript support for built-in APIs
npm i -D @types/node
```

Once complete, you can run your TypeScript code using `tsx src/your-code.ts`.

## Installation

Install `@xmtp/agent-sdk` as a dependency in your project.

:::code-group

```bash [npm]
npm i @xmtp/agent-sdk
```

```bash [pnpm]
pnpm i @xmtp/agent-sdk
```

```bash [yarn]
yarn add @xmtp/agent-sdk
```

```bash [bun]
bun i @xmtp/agent-sdk
```

## Environment variables

To run an example XMTP agent, you must create a `.env` file with the following [environment variables](https://nodejs.org/api/environment_variables.html):

```bash
XMTP_WALLET_KEY=0x # the private key of your wallet
XMTP_DB_ENCRYPTION_KEY=0x # encryption key for your local database
XMTP_ENV=dev # the XMTP network: local, dev, production
```

- **`XMTP_WALLET_KEY`**: The private key of your [EOA wallet address](/chat-apps/core-messaging/create-a-signer#create-a-eoa-or-scw-signer). If you don't have a wallet or simply want one for testing, you can generate keys here: [Agent SDK Starter](https://xmtp.github.io/agent-sdk-starter/).

- **`XMTP_DB_ENCRYPTION_KEY`**: A key used to encrypt your local database. You can choose any value, but it must be exactly 64 hex characters (32 bytes).

- **`XMTP_ENV`**: The XMTP network your agent connects to:
  - `local` â€” For running against a local XMTP backend.
  - `dev` â€” For using the XMTP test network.
  - `production` â€” For making your agent discoverable on production apps like [Base](https://base.app/) or [World](https://world.org/)

## Usage

This example shows how to create an agent based on your `.env` file that sends a message when it receives a text message.

```ts [Node]
import { Agent, getTestUrl } from '@xmtp/agent-sdk';

// 2. Spin up the agent
const agent = await Agent.createFromEnv({
  env: 'dev', // or 'production'
});

// 3. Respond to text messages
agent.on('text', async (ctx) => {
  await ctx.conversation.sendText('Hello from my XMTP Agent! ðŸ‘‹');
});

// 4. Log when we're ready
agent.on('start', () => {
  console.log(`Waiting for messages...`);
  console.log(`Address: ${agent.address}`);
  console.log(`ðŸ”— ${getTestUrl(agent.client)}`);
});

await agent.start();
```

### Local database

:::danger

Each time you run your agent, XMTP creates local database files that must be **kept between restarts and between deployments**. Without persistent volumes, each restart creates a new installation and you're **limited to 10 installations per inbox**.

To learn more, see [Manage agent local database files and installations](/agents/build-agents/local-database).

:::

XMTP creates local database files in the `dbPath` (default is `'/'`) directory. These files store your device identity and message history.

## Vibe coding

See these [Cursor rules](https://github.com/xmtplabs/xmtp-agent-examples/blob/main/.cursor/rules/xmtp.mdc) for vibe coding agents with XMTP using best practices.

```bash
Prompt: lets create an example that gets a number and returns its 2x multiple (use claude max)
```

## Talk to your agent

Try out the example agents using [xmtp.chat](https://xmtp.chat), the official playground for agents.

![xmtp.chat DM screenshot](https://github.com/xmtplabs/xmtp-agent-examples/raw/main/examples/xmtp-gm/screenshot.png)

## Debug an agent

To learn more, see [Debug an agent](/agents/deploy/debug-agents)

## Deploy an agent

To learn more, see [Deploy an agent](/agents/deploy/deploy-agent).

## Agent examples

Visit the [examples](https://github.com/xmtplabs/xmtp-agent-examples) repository for more agent examples.
