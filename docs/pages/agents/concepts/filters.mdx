# Built‑in filters

Instead of manually checking every incoming message, you can use the provided filters.

## Example

```ts
import { Agent, filter } from '@xmtp/agent-sdk';

const agent = await Agent.createFromEnv();

// Using filter in message handler
agent.on('text', async (ctx) => {
  if (filter.isText(ctx.message)) {
    await ctx.sendText('You sent a text message!');
  }
});

// Combine multiple conditions
agent.on('text', async (ctx) => {
  if (
    filter.hasContent(ctx.message) &&
    !filter.fromSelf(ctx.message, ctx.client) &&
    filter.isText(ctx.message)
  ) {
    await ctx.sendText('Valid text message received ✅');
  }
});
```

For convenience, the `filter` object can also be imported as `f`:

```ts
// You can import either name:
import { filter, f } from '@xmtp/agent-sdk';

// Both work the same way:
if (f.isText(ctx.message)) {
  // Handle message...
}
```

## Built-in content type filtering

For built-in content types, use type guard methods on the context:

```ts
import { Agent } from '@xmtp/agent-sdk';

const agent = await Agent.createFromEnv();

agent.on('message', async (ctx) => {
  // Use type guard methods for built-in content types
  if (ctx.isReaction()) {
    // ctx.message.content is now typed as Reaction
    console.log(`Reaction: ${ctx.message.content.content}`);
    console.log(`Action: ${ctx.message.content.action}`);
  }
  
  if (ctx.isReply()) {
    // ctx.message.content is now typed as EnrichedReply
    console.log(`Reply: ${ctx.message.content.content}`);
  }
});
```

## Custom content type filtering

Use the `usesCodec` filter to check for custom content types with full TypeScript type inference:

```ts
import { Agent, filter } from '@xmtp/agent-sdk';
import { MyCustomCodec } from './my-custom-codec';

const agent = await Agent.createFromEnv();

agent.on('message', async (ctx) => {
  // Works with custom content types
  if (filter.usesCodec(ctx.message, MyCustomCodec)) {
    // ctx.message.content is now typed to MyCustomCodec's decoded type
    console.log('Received custom content:', ctx.message.content);
  }
});
```

This is particularly useful when you need to handle multiple custom content types or want precise type inference for your message content.

## Available filters

- `fromSelf`
- `hasContent`
- `isDM`
- `isGroup`
- `isGroupAdmin`
- `isGroupSuperAdmin`
- `isReaction`
- `isReply`
- `isRemoteAttachment`
- `isText`
- `isTextReply`
- `usesCodec`

To learn more about all available prebuilt filters, see [filter.ts](https://github.com/xmtp/xmtp-js/blob/main/sdks/agent-sdk/src/core/filter.ts).
