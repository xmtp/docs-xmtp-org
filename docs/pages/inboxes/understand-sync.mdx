# Understand syncing messaging data with XMTP

**Apps built with XMTP aren't like mainstream messaging appsâ€”and that can be a good thing**

Most mainstream messaging apps store and sync user messaging data on centralized servers, which offers seamless, cross-device sync. But that convenience comes with a cost: user data is often retained in ways that can compromise privacy and security.

XMTP, on the other hand, is built on **Messaging Layer Security (MLS)** with **forward secrecy** and **post-compromise security**. These cryptographic guarantees give users, not platforms, control of their messaging data. But this powerful shift in control doesn't come without changes to how a user's conversations, messages, and consent preferences can sync across their devices and apps.

This means that your app built with XMTP may not be able to behave like a typical messaging app in every wayâ€”but thatâ€™s a feature, not a bug. With XMTP, you can build highly secure apps where users control the intentional and explicit syncing of their messaging data.

This guide covers best practices for achieving the best UX for syncing user messaging data while upholding the security guarantees provided by XMTP.

## ðŸŽ¥ walkthrough: Syncing

This video provides a walkthrough of key concepts required to implement syncing correctly.

<iframe width="560" height="315" src="https://www.youtube.com/embed/jl7P0onApxw?si=YNafIHebx9Kxycos" title="YouTube video player" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerPolicy="strict-origin-when-cross-origin" allowFullScreen></iframe>

## Sync messaging data history across devices

**Goal**: My user uses an XMTP app on their phone. When they log into the same XMTP app on their tablet, I want them to see all of their conversations, messages, and consent preferences there, too.

**How to achieve it**: You can achieve this user experience using [history sync](/inboxes/history-sync) and by prompting the user for explicit actions in your app UI.

History sync is enabled by default. 

History sync requires that both devices (phone and tablet in this case) be online to enable the user's conversations, messages, and consent to be synced across devices. 

To guide the user through using their devices to perform the history sync, you can implement a UX like the following:

1. In the app on the requesting device, give the user a way to request an import of their messaging data history.

   <figure>
      <img src="https://raw.githubusercontent.com/xmtp/docs-xmtp-org/refs/heads/main/docs/pages/img/requestor.png" width="300px" />
      <figurecaption><em>Requesting device</em></figurecaption>
   </figure>

2. Prompt the user to verify that they want to perform the import.

   <figure>
      <img src="https://raw.githubusercontent.com/xmtp/docs-xmtp-org/refs/heads/main/docs/pages/img/confirm-request.png" width="300px" />
      <figurecaption><em>Requesting device</em></figurecaption>
   </figure>

3. Show the user that the import was requested.

   <figure>
      <img src="https://raw.githubusercontent.com/xmtp/docs-xmtp-org/refs/heads/main/docs/pages/img/provider.png" width="300px" />
      <figurecaption><em>Requesting device</em></figurecaption>
   </figure>

4. In the app on the provider device, prompt the user to confirm or deny the import request.

   <figure>
      <img src="https://raw.githubusercontent.com/xmtp/docs-xmtp-org/refs/heads/main/docs/pages/img/provider-confirm.png" width="300px" />
      <figurecaption><em>Provider device</em></figurecaption>
   </figure>

5. In the app on the requesting device, start the import and display its progress.

   <figure>
      <img src="https://raw.githubusercontent.com/xmtp/docs-xmtp-org/refs/heads/main/docs/pages/img/requestor-import-progress.png" width="300px" />
      <figurecaption><em>Requesting device</em></figurecaption>
   </figure>

6. Once the import is complete, apps on both the requesting and provider devices should have the same conversations, messages, and consent preferences.

   <figure>
      <img src="https://raw.githubusercontent.com/xmtp/docs-xmtp-org/refs/heads/main/docs/pages/img/sync-complete.png" width="625px" />
      <figurecaption><em>Requesting device and provider device</em></figurecaption>
   </figure>

## Sync messaging data history across apps

**Goal**: My user uses App ABC built with XMTP. When they log into App XYZ, also built with XMTP, I want them to see all of their conversations, messages, and consent preferences there, too.

**How to achieve it**: You can achieve this user experience using [history sync](/inboxes/history-sync) and by prompting the user for explicit actions in your app UI.

History sync is enabled by default. 

History sync requires that both the apps be online to enable the user's conversations, messages, and consent to be synced across devices. 

To guide the user through using their apps to perform the sync, you can implement a UX like the following:

1. In the requesting app (App XYZ) give the user a way to request an import of their messaging data history.
2. Prompt the user to verify that they want to perform the import.
3. Show the user that the import was requested.
4. In the provider app (App ABC), prompt the user to confirm or deny the import request.
5. In the requesting app, start the import and display its progress.
6. Once the import is complete, both App ABC and App XYZ should have the same conversations, messages, and consent preferences.

For app UI mockups, see the examples in [Sync messaging data history across devices](#sync-messaging-data-history-across-devices).

## Prevent syncing with malicious apps

**Scenario**: I want to protect my users from syncing their messaging data history with a malicious app.

**How to achieve it**: Consider making history sync an opt-in feature for users. This gives you the opportunity to educate your users about how history sync works before offering them the option to use it.

After a user opts-in to history sync, you can guide the user through using their apps to perform the sync using the UX described in the previous section.

This can help ensure that users sync their messaging data history with only the apps they trust.

## Block users across apps

**Scenario**: When my user blocks a user on App ABC, I want the user to also be blocked on App XYZ.

**How to achieve it**: When the user blocks a user in App ABC, the app should publish the user block consent record by calling `sync` on the user's [sync group](/inboxes/history-sync#sync-group).

When the user subsequently opens App XYZ, the app should call `sync` on the user's sync group to be able to get the user block consent record.

Alternatively, the apps can call `syncAll` on the sync group instead of `sync`.

## Block users across devices

**Scenario**: When my user blocks someone on their phone, I want the user to also be block on their tablet.

**How to achieve it**: When the user blocks a user in an on app their phone, the app should publish the user block consent record by calling `sync` on the user's [sync group](/inboxes/history-sync#sync-group).

When the user subsequently opens the same app on their tablet, the app should call `sync` on the user's sync group to be able to get the user block consent record.

Alternatively, the apps can call `syncAll` on the sync group instead of `sync`.

## Currently unsupported recovery scenarios

**Scenario**: My user used an app built with XTMP on their phone, and then deleted the app. I want them to be able to reinstall the app and get access to all of their messaging data history.

Currently, this is not possible. This may be possible in the future with a backups feature.

**Scenario**: My user used an app built with XMTP on their phone. They lost their phone and got a new one. I want them to be able to install the app on their new phone and get access to all of their messaging data history.

Currently, this is not possible. This may be possible in the future with a backups feature.

**Scenario**: My user lost access to an app built with XMTP (deleted it or lost their phone) and then reinstalled the app. I know they can't get back access to all of their messaging data history, but they see *some* of their pre-existing conversations showing up in the app.

The user may see some of their pre-existing conversations display in the app and be able to send and receive new messages in them. 

This behavior may lead the user to believe that all of their messaging data history is syncing. However, the only conversations that will show up in their app are the conversations they have with other users who open their apps built with XMTP. For example:

1. Alix is in a DM and 4 group chats with Bo and a DM with Caro.
2. Alix deletes and reintalls their app.
3. Bo opens their app, which runs sync. Sync looks to see if any members of their conversations have new installations, finds Alix's new installation, and adds Alix to the DM and 4 group chats they have with Bo.
4. Alix opens her app, which runs sync and displays the DM and 4 group chats with Bo that their new installation was added to.
5. Caro doesn't open their app, so it can't run sync. Therefore, it doesn't find Alix's new installation and doesn't add Alix to their DM.
